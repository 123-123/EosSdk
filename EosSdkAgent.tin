// Copyright (c) 2013 Arista Networks, Inc.  All rights reserved.
// Arista Networks, Inc. Confidential and Proprietary.

#include <Tac/Tracing.h>
#include <EosSdk/Mount.h>
#include <EosSdk/panic.h>

DEFAULT_TRACE_HANDLE( "EosSdkAgent" )

namespace eos {

void
Agent::doInit() {
   TRACE8( __PRETTY_FUNCTION__ );
   
   Sysdb::MountGroup::Ptr mg = entityManager()->getMountGroup( this );
   askAllMountHandlersToDoTheirMounts( mg );
   mg->doClose( false, "", 0 );
}

void
Agent::doMountsComplete( Sysdb::MountStatus mountStatus,
                         Sysdb::EntityManager::Ptr const & em ) {
   TRACE8( __PRETTY_FUNCTION__ );
   if( mountStatus != Sysdb::mountSuccess_ ) {
      panic("error code %d mounting sysdb", (int) mountStatus);
   }
   notifyAllMountHandlersThatAllMountsAreComplete( em );
}

};
